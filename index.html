<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>èª­æ›¸æ‰‹å¸³ â€” Japanese Reading Companion</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;400;700&family=Crimson+Pro:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>

<body>

<header>
  <div>
    <h1>èª­æ›¸æ‰‹å¸³</h1>
  </div>

  <div class="theme-dots" aria-label="Theme">
    <button class="theme-dot flowers" data-theme="flowers" title="Flowers"></button>
    <button class="theme-dot joyful"  data-theme="joyful"  title="Joyful"></button>
    <button class="theme-dot plum"    data-theme="plum"    title="Plum"></button>
  </div>

  <span>Japanese Reading Companion</span>
</header>

<nav>
  <button class="active" onclick="showPanel('lookup', this)">ğŸ” Lookup</button>
  <button onclick="showPanel('books', this)">ğŸ“– Books</button>
  <button onclick="showPanel('writing', this)">âœï¸ Handwriting</button>
  <button onclick="showPanel('radicals', this)">éƒ¨é¦– Radicals</button>
  <button onclick="showPanel('flashcards', this)">ğŸƒ Flashcards</button>
</nav>

<main>

  <!-- LOOKUP PANEL -->
  <section class="panel active" id="panel-lookup">
    <div class="lookup-grid">
      <div class="card">
        <h2>Word Search â€” å˜èªæ¤œç´¢</h2>
        <div class="search-bar">
          <input id="search-input" type="text" placeholder="Enter kanji, kana, or romajiâ€¦" autocomplete="off">
          <button class="btn" type="button" onclick="lookupWord()">Search</button>
        </div>
        <div id="results"><p class="status-msg">Search for any Japanese word above.</p></div>
      </div>
      <div class="card">
        <h2>Quick Notes â€” ãƒ¡ãƒ¢</h2>
        <textarea id="quick-notes" class="notes-textarea" placeholder="Jot down notes, sentences, contextâ€¦"></textarea>
      </div>
    </div>
  </section>

  <!-- BOOKS PANEL -->
  <section class="panel" id="panel-books">
    <div class="lists-layout">
      <div>
        <div class="card" style="margin-bottom:0">
          <h2>Books â€” æœ¬</h2>
          <div class="new-book-form">
            <input id="new-book-input" type="text" placeholder="Book titleâ€¦" onkeydown="if(event.key==='Enter')addBook()">
            <button class="btn btn-sm" type="button" onclick="addBook()">+</button>
          </div>
          <div class="book-list" id="book-list"></div>
        </div>
      </div>

      <div class="card">
        <h2 id="book-detail-title">Book â€” è©³ç´°</h2>

        <div id="book-meta-controls" style="display:none;gap:10px;flex-wrap:wrap;align-items:center;margin:10px 0 14px">
          <div class="meta-chip">
            <label for="book-status" class="meta-label">Status</label>
            <select id="book-status" class="meta-select">
              <option value="reading">Reading</option>
              <option value="read">Read</option>
            </select>
          </div>

          <div class="meta-chip">
            <span class="meta-label">Rating</span>
            <div id="book-rating" class="star-row" aria-label="Rating"></div>
          </div>

          <button class="btn btn-sm btn-outline" type="button" onclick="deleteBook()">Delete Book</button>
        </div>

        <div id="book-detail-content"><p class="empty-state">Select or create a book to see details.</p></div>
      </div>
    </div>
  </section>

  <!-- HANDWRITING PANEL -->
  <section class="panel" id="panel-writing">
    <div class="writing-layout">
      <div class="card canvas-wrap">
        <h2>Handwriting â€” æ‰‹æ›¸ã</h2>

        <div class="hw-row">
          <div class="hw-box">
            <canvas id="writing-canvas-1" width="420" height="350"></canvas>
            <div class="canvas-controls">
              <button class="btn btn-sm btn-outline" type="button" onclick="hwClear(1)">Clear</button>
              <button class="btn btn-sm" type="button" onclick="hwRecognize(1)">Recognize</button>
            </div>
            <div id="hw-status-1" class="status-msg">Draw a kanji, then click Recognize.</div>
            <div id="hw-candidates-1" class="candidate-row"></div>
          </div>

          <div class="hw-box">
            <canvas id="writing-canvas-2" width="420" height="350"></canvas>
            <div class="canvas-controls">
              <button class="btn btn-sm btn-outline" type="button" onclick="hwClear(2)">Clear</button>
              <button class="btn btn-sm" type="button" onclick="hwRecognize(2)">Recognize</button>
            </div>
            <div id="hw-status-2" class="status-msg">Draw a kanji, then click Recognize.</div>
            <div id="hw-candidates-2" class="candidate-row"></div>
          </div>
        </div>

        <div class="search-bar" style="margin-top:14px">
          <input id="hw-query" type="text" placeholder="Click candidates to build a wordâ€¦" autocomplete="off">
          <button class="btn" type="button" onclick="hwSearchWord()">Search</button>
          <button class="btn btn-outline" type="button" onclick="hwClearQuery()">Clear</button>
        </div>

        <div id="hw-word-suggestions"><p class="status-msg">Build a query to see suggestions.</p></div>
      </div>
    </div>
  </section>

  <!-- RADICALS PANEL -->
  <section class="panel" id="panel-radicals">
    <div class="radical-layout">
      <div class="card">
        <h2>Radical Picker â€” éƒ¨é¦–</h2>
        <p class="radical-info">Select one or more parts, then click â€œGet Kanjiâ€. Click candidate kanji to build a word.</p>

        <div id="selected-radicals-display" class="selected-radicals">â€”</div>
        <div class="stroke-filter" id="stroke-filter"></div>
        <div class="radical-grid" id="radical-grid"></div>

        <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
          <button class="btn" type="button" onclick="searchByRadicals()">Get Kanji</button>
          <button class="btn btn-outline" type="button" onclick="clearRadicals()">Clear</button>
        </div>
      </div>

      <div class="card">
        <h2>Build Word â€” çµ„ã¿åˆã‚ã›</h2>

        <div class="search-bar">
          <input id="radical-query" type="text" placeholder="Click kanji candidates to buildâ€¦" autocomplete="off">
          <button class="btn" type="button" onclick="radicalSearchWord()">Search</button>
          <button class="btn btn-outline" type="button" onclick="radicalClearAll()">Clear</button>
        </div>

        <div id="radical-kanji-candidates"><p class="status-msg">Select radicals and click â€œGet Kanjiâ€.</p></div>
        <div id="radical-word-suggestions"><p class="status-msg">Build a query to see suggestions.</p></div>
      </div>
    </div>
  </section>

  <!-- FLASHCARDS PANEL -->
  <section class="panel" id="panel-flashcards">
    <div class="fc-setup" id="fc-setup">
      <div class="card">
        <h2>Study Session â€” å‹‰å¼·</h2>
        <p class="status-msg">Choose books and start.</p>
        <div class="fc-book-grid" id="fc-book-grid"></div>

        <div class="fc-options">
          <div class="fc-option-row">
            <label>Show</label>
            <select id="fc-mode">
              <option value="kanji-to-meaning">Kanji â†’ Meaning</option>
              <option value="meaning-to-kanji">Meaning â†’ Kanji</option>
              <option value="reading-to-meaning">Reading â†’ Meaning</option>
            </select>
          </div>
          <div class="fc-option-row">
            <label>Order</label>
            <select id="fc-order">
              <option value="random">Random</option>
              <option value="sequential">Sequential</option>
              <option value="hard-first">Hard first</option>
            </select>
          </div>
          <div class="fc-option-row">
            <label>Limit</label>
            <select id="fc-limit">
              <option value="0">All cards</option>
              <option value="10">10 cards</option>
              <option value="20">20 cards</option>
              <option value="30">30 cards</option>
              <option value="50">50 cards</option>
            </select>
          </div>
        </div>
      </div>

      <div style="text-align:center">
        <button class="btn" style="padding:12px 36px;font-size:1.1rem;letter-spacing:0.1em" type="button" onclick="startFlashcards()">Start Study é–‹å§‹</button>
      </div>
    </div>

    <div class="fc-study" id="fc-study">
      <div class="fc-progress-bar-wrap">
        <span id="fc-count">0 / 0</span>
        <div class="fc-progress-bar"><div class="fc-progress-fill" id="fc-progress-fill" style="width:0%"></div></div>
        <button class="btn btn-sm btn-outline" type="button" onclick="endSession()">End</button>
      </div>

      <div class="fc-session-stats">
        <div class="fc-stat"><span class="val" id="stat-again">0</span>Again</div>
        <div class="fc-stat"><span class="val" id="stat-hard">0</span>Hard</div>
        <div class="fc-stat"><span class="val" id="stat-good">0</span>Good</div>
        <div class="fc-stat"><span class="val" id="stat-easy">0</span>Easy</div>
      </div>

      <div class="fc-card-scene" id="fc-card-scene" onclick="flipCard()">
        <div class="fc-card-inner" id="fc-card-inner">
          <div class="fc-card-face fc-front">
            <div class="fc-hint" id="fc-front-hint">KANJI</div>
            <div class="fc-word" id="fc-front-word">â€”</div>
            <div class="fc-reading-front" id="fc-front-sub"></div>
            <div class="fc-tap-hint">tap to reveal</div>
          </div>
          <div class="fc-card-face fc-back">
            <div class="fc-hint">ANSWER</div>
            <div class="fc-word-back" id="fc-back-word"></div>
            <div class="fc-meaning-back" id="fc-back-meaning"></div>
            <div class="fc-reading-back" id="fc-back-reading"></div>
          </div>
        </div>
      </div>

      <div class="fc-ratings" id="fc-ratings">
        <button class="fc-rating-btn fc-btn-again" type="button" onclick="rateCard('again')"><span class="label">Again</span><span class="sub">ã‚‚ã†ä¸€åº¦</span></button>
        <button class="fc-rating-btn fc-btn-hard" type="button" onclick="rateCard('hard')"><span class="label">Hard</span><span class="sub">é›£ã—ã„</span></button>
        <button class="fc-rating-btn fc-btn-good" type="button" onclick="rateCard('good')"><span class="label">Good</span><span class="sub">ã‚ã‹ã£ãŸ</span></button>
        <button class="fc-rating-btn fc-btn-easy" type="button" onclick="rateCard('easy')"><span class="label">Easy</span><span class="sub">ç°¡å˜</span></button>
      </div>

      <div class="fc-shortcuts">Space / Enter = flip &nbsp;|&nbsp; 1 Again &nbsp; 2 Hard &nbsp; 3 Good &nbsp; 4 Easy</div>
    </div>

    <div class="fc-results" id="fc-results">
      <div class="fc-results-title">Session Complete å®Œäº†</div>
      <div class="fc-results-grid" id="fc-results-grid"></div>
      <div class="fc-again-list" id="fc-again-list" style="display:none">
        <h3>Review Again â€” è¦å¾©ç¿’</h3>
        <div id="fc-again-items"></div>
      </div>
      <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center">
        <button class="btn" type="button" onclick="restartSession()">Study Again</button>
        <button class="btn btn-outline" type="button" onclick="backToSetup()">Change Settings</button>
      </div>
    </div>
  </section>

</main>

<script src="state.js"></script>
<script src="nav.js"></script>
<script src="books.js"></script>
<script src="lookup.js"></script>
<script src="handwriting.js"></script>
<script src="radicals.js"></script>
<script src="flashcards.js"></script>
<script src="init.js"></script>

</body>
</html>
